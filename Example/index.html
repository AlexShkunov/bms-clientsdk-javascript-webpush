<!DOCTYPE html>
<html lang="en" class="no-js">
<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="manifest" href="manifest.json">
  <title>BMD Enterprise</title>
  <meta name="description" content="BMD Enterprise (An IBM Company)" />
  <meta name="author" content="Ananth" />


</head>
<body onload="myFunction();">
   <table>
      <tr>
        <td style= "width:30%;">
          <img class = "newappIcon" src="images/newapp-icon.png">
        <td>
            <h1>Hi there!</h1>
          <p>Thanks for creating a
            <span class = "blue">Bluemix Web Push example</span>.
    </table>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->

<script src="BMSPushSDK.js" async></script>
  <script>

  function myFunction() {

      var bmsPush = new BMSPush(); //create an instance of BMSPush
      bmsPush.isDebugEnable(true) // for debugging
      function callback(response) {
        alert(response.response)
      }
      var params = {
        "appGUID":"push app GUID",
        "appRegion":"App Region"
        //"clientSecret":"Push Client Secret" (optional)
      }
      bmsPush.initialize(params, callback) // initialize Push Service
      //res.registerWithUserId("UserId", function(response) { // register device with userId in push service
      bmsPush.register(function(response) { // register device in push service
        alert(response.response)
        bmsPush.retrieveAvailableTags(function(response) { //Retrieve available tags
          alert(response.response)
          alert("here you go")
          var json = JSON.parse(response.response);
          var tagsA = []
          for (i in json.tags){
            tagsA.push(json.tags[i].name)
            alert(json.tags[i].name)
          }
          alert(tagsA)
          bmsPush.subscribe(tagsA,function(response) { // subscribe to available tags
              alert(response.response)
              tagsA.shift();
              bmsPush.unSubscribe(tagsA,function(response) { // unsubscribe from tags
                  alert(response.response)
                  bmsPush.unRegisterDevice(function(response) { // unregister device
                      alert(response.response)
                    })
                })
          })
        })
      })
  }
  </script>

</body>
</html>
